<!DOCTYPE html>
<html xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{admin/dashboardLayout.html}"  xmlns:th="http://www.thymeleaf.org">
	
<head>
<meta charset="UTF-8">
<title>Sản phẩm</title>
<style type="text/css">
#andi {
    display: none;
}
</style>
</head>
<body>
	  <div  class="row" layout:fragment="content">
	            <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center py-4">
                <div class="d-block mb-4 mb-md-0">
                    <nav aria-label="breadcrumb" class="d-none d-md-inline-block">
                        <ol class="breadcrumb breadcrumb-dark breadcrumb-transparent">
                        
                            <li class="breadcrumb-item">
                                <a href="#">
                                    <svg class="icon icon-xxs" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path></svg>
                                </a>
                            </li>
                            
                            <li class="breadcrumb-item active" aria-current="page">Sản phẩm</li>
                        </ol>
                    </nav>
                    <h2 class="h4">Tất cả sản phẩm</h2>
                   
                </div>
              
                <div class="btn-toolbar mb-2 mb-md-0">
                    <button  id="showadd" class="btn btn-sm btn-gray-800 d-inline-flex align-items-center">
                        <svg class="icon icon-xs me-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg>
                        Thêm sản phẩm
                    </button>
                <!--    <div class="btn-group ms-2 ms-lg-3">
                        <button type="button" class="btn btn-sm btn-outline-gray-600">Share</button>
                        <button type="button" class="btn btn-sm btn-outline-gray-600">Export</button>
                    </div>
                    -->  
                </div>
            </div>
           <div class="table-settings mb-4">
                <div class="row align-items-center justify-content-between">
               <div class="col-9 col-lg-8 d-md-flex"><div class="input-group me-2 me-lg-3 fmxw-300"><span class="input-group-text"><svg class="icon icon-xs" x-description="Heroicon name: solid/search" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd"></path></svg> </span>
               <input type="text" class="form-control" id="myInput" oninput="searchByName(this)"  placeholder="Tìm theo tên sản phảm"></div>
               
               <select id="metlamroi" class="form-select fmxw-200 d-none d-md-inline"  aria-label="Message select example 2">
	               <option  value="2" selected="selected" >Tất cả</option>
	               <option  value="0">Hoạt động</option>
	               <option value="1">Ngừng kinh doanh</option>
               </select></div>
                    <div class="col-4 col-md-2 col-xl-1 ps-md-0 text-end">
                        <div class="dataTable-dropdown"><label><select id="showme" class="dataTable-selector"><option value="5">5</option><option value="10" >10</option><option value="15" selected="selected">15</option><option value="20">20</option><option value="25">25</option></select> </label></div>
                    </div>
                </div>
            </div>


<!-- Modal Content -->
<div class="modal fade" id="modalSubscribe" tabindex="-1" role="dialog" aria-labelledby="modalTitleSubscribe" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
    
        <div class="modal-contentss">
         <div class="modal-header">
                <h2 class="h6 modal-title" id="addzise">Thêm sản phẩm</h2>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
           <form id="formproduct" action="#" method="post" class="card border-0 shadow">
           <div class="card-body p-0 p-md-4"><div class="row justify-content-center">
            <div class="col-12 col-lg-6 khang"><div class="form-group mb-4">
           <label for="cartInputEmail1">Product id *</label>
            <input type="email" class="form-control1" placeholder="Enter your product name" id="idproducts" name="idproduct" aria-describedby="cartInputEmail1" required=""></div></div>
           <div class="col-12 col-lg-6"><div class="form-group mb-4">
           <label for="cartInputEmail1">Tên sản phẩm</label>
            <input type="email" class="form-control1" id="productName" name="Product_Name" aria-describedby="cartInputEmail1" required=""></div></div>
           <div class="col-12 col-lg-6"> 
           		<label for="country">Danh mục</label> 
           			<select class="form-control1 mb-4" id="Id_Category1" name="idcategory" aria-label="Country select example">
           			<option  value="0">Chọn...</option>
           				 <option th:each="item : ${category} " th:value="${item.Id_Category}"
                                  th:text="${item.Category_Name}"  ></option>
           			</select></div>
           <div class="col-12 col-lg-6"> <label for="country">Thương hiệu</label> 
           <select class="form-control1 mb-4" id="idbrand1" name="idbrand" aria-label="Country select example">
           <option value="0">Chọn...</option>
           		<option th:each="item : ${brand} " th:value="${item.Id_Brand}" 
                                  th:text="${item.brand_Name}"  ></option>
           </select></div>

           <div class="col-12 col-lg-6"><div class="form-group mb-4"><label for="cartInputAddress1">Chất liệu</label> 
           <input type="text"  class="form-control1" id="fabric_material" name="fabric_material" aria-describedby="cartInputAddress1"></div></div>
           <div class="col-12 col-lg-6"><div class="form-group mb-4"><label for="cartInputAddress1">Giá nhập</label> <div class="input-group">
                  
           <input type="number" class="form-control1" id="price1" name="gianhap" >
           
                                         
 					  </div></div></div>
 					   <div class="col-12 col-lg-6" ><div class="form-group mb-4" ><label for="cartInputAddress1">Giá bán</label> <div class="input-group">
                  
           <input type="number" class="form-control1" id="pricegiaban" name="giaban">
           
                                         
 					  </div></div></div>
 					   <script>
                            function chomesFile(fieldInput){
                                if(fieldInput.files && fieldInput.files[0])
                                var reader = new FileReader();
                                reader.onload = function(e){
                                    $('#image').attr('src', e.target.result);
                                }
                                reader.readAsDataURL(fieldInput.files[0]);
                            }
    
                        </script>
                        
 					 	<div class="col-12 col-lg-6 addclose" id="bingdingimage">
 					 <div class="mb-4" >
 					 
  		<label for="formFile" class="form-label">Ảnh đại  diện</label>
  		
  		<input class="form-control" type="file" onchange="chomesFile(this)" id="formFile" name="imageFile">
</div>
<img  id="image" class="img-fluid" src="" width="50%"alt="">
 					 </div>
 					  
 					
 
 	
 	<div class="col-12 col-lg-6 addclose" id="bingdingimagen">
 					 <div class="mb-4" >
 					 
  		<label for="formFiles" class="form-label">Ảnh nền</label>
  		
  		<input class="form-control" type="file" onchange="chomesFiles(this)" id="formFiles" name="iamgenen">
</div>
<img  id="imagenen" class="img-fluid" src="" width="50%"alt="">
 					 </div>
 					 
 					 <script>
                            function chomesFiles(fieldInput){
                                if(fieldInput.files && fieldInput.files[0])
                                var reader = new FileReader();
                                reader.onload = function(e){
                                    $('#imagenen').attr('src', e.target.result);
                                }
                                reader.readAsDataURL(fieldInput.files[0]);
                            }
    
                        </script>
 					 
 					 
 					 
 					 
 					 
 					 
 					 <div class="form-group mb-4"><label for="textarea">Mô tả</label>
<textarea class="form-control" placeholder="" id="descriptions" name="descriptions" rows="4"></textarea></div>
 				
             <div class="modal-header">
              
                   </div>
            
 				  </div></div>
            </form>
             <div id="containerptoductdetail" onclick="xoadi(this)">
             <div class="detailsproduct"> 
 				  <div class="modal-header">
                <h2 class="h6 modal-title" id="addzise">Chi tiết sản phẩm</h2>
                   </div>
                 <div id="contrainerdetails" class="card-body p-0 p-md-4"><div class="row justify-content-center ">
                   <div class="col-12 col-lg-6"> <label for="country">Màu sắc</label> 
           <select class="form-control1 mb-4" id="iddetailsproductcolor" name="idproductColor" aria-label="Country select example">
           <option value="0">Chọn...</option>
           		<option th:each="item : ${color} " th:value="${item.Id_Product_Color}" 
                                  th:text="${item.Color_Name}"  ></option>
           </select></div>         
            <div class="col-12 col-lg-6"> <label for="country">Kích thước</label> 
           <select class="form-control1 mb-4" id="iddetailssize" name="idsize" aria-label="Country select example">
           <option value="0">Chọn...</option>
           		<option th:each="item : ${size} " th:value="${item.Id_Size}" 
                                  th:text="${item.Size_Name}"  ></option>
           </select>
           </div>
           <div class="col-12 col-lg-6"><div class="form-group mb-4"><label for="cartInputAddress1">Số lượng</label> <div class="input-group">
                  
           <input type="number" class="form-control1" id="quantity" name="quantity" min="1" >
                                        
 					  </div></div></div>
 				
             <div class="col-12 col-lg-6"><div class="form-group mb-4">
           <label for="cartInputEmail1">Hướng dẫn sử dụng</label>
            <input type="text" class="form-control1" id="hdsd"  name="hdsd" aria-describedby="cartInputEmail1" required=""></div></div>
             <div class="col-12 col-lg-6" id="andi"><div class="form-group mb-4">
           <label for="cartInputEmail1">User_manual *</label>
            <input type="email" class="form-control" placeholder="Enter your user_manual" id="user_Manual" value="0" name="Usermanual" aria-describedby="cartInputEmail1" required=""></div></div>
                 </div>
                
               </div>
            </div>
            </div>
           
            <div id="addproductdeltai" class="detailsproduct">
          
             <button type="button" class="btn-close"  onclick="xoactsp(this)" aria-label="Close"></button>
                 <div class="modal-header" id="xoactsp">
                <h2 class="h6 modal-title" id="addzise">Chi tiết sản phẩm</h2>
                
                   </div>
                    <div id="contrainerdetails" class="card-body p-0 p-md-4"><div class="row justify-content-center detailsproduct">
              <div class="col-12 col-lg-6"> <label for="country">Màu sắc</label> 
           <select class="form-control1 mb-4" id="iddetailsproductcolor" name="idproductColor" aria-label="Country select example">
           <option value="0">Chọn...</option>
           		<option th:each="item : ${color} " th:value="${item.Id_Product_Color}" 
                                  th:text="${item.Color_Name}"  ></option>
           </select></div>              
            <div class="col-12 col-lg-6"> <label for="country">Khích thước</label> 
           <select class="form-control1 mb-4" id="iddetailssize" name="idsize" aria-label="Country select example">
           <option value="0">Chọn...</option>
           		<option th:each="item : ${size} " th:value="${item.Id_Size}" 
                                  th:text="${item.Size_Name}"  ></option>
           </select>
           </div>
           <div class="col-12 col-lg-6"><div class="form-group mb-4"><label for="cartInputAddress1">Số lượng</label> <div class="input-group">
                  
           <input type="number" class="form-control1" id="quantity" name="quantity">
                                        
 					  </div></div></div>
 					  
             <div class="col-12 col-lg-6"><div class="form-group mb-4">
           <label for="cartInputEmail1">Hướng dẫn sử dụng</label>
            <input type="text" class="form-control1" id="hdsd"  name="hdsd" aria-describedby="cartInputEmail1" required=""></div></div>
             <div class="col-12 col-lg-6" id="andi"><div class="form-group mb-4">
           <label for="cartInputEmail1">User_manual *</label>
            <input type="email" class="form-control" placeholder="Enter your user_manual" id="user_Manual" value="0" name="Usermanual" aria-describedby="cartInputEmail1" required=""></div></div>
                 </div>

                  
                
         	
            </div>
             
              
            </div>
            <div class="modal-header">
              <h2 class="h6 modal-title" id="addzise"></h2>
                 <button type="button" id="btnaddproductdetails" class="btn btn-gray-800 ms-lg-3 animate-up-2" > <svg class="icon icon-xs me-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg> Thêm chi tiết</button>
                
                   </div>
            <div class="modal-footer">
                <button type="button" id="btnsaveproduct" class="btn btn-secondary">Lưu</button>
                 <button type="button" id="btnupdate" class="btn btn-secondary">Câph nhật</button>
                <button type="button" class="btn btn-link text-gray" data-bs-dismiss="modal">Huỷ bỏ</button>
            </div>
        </div>
        
    </div>
   
</div>

<!-- End of Modal Content -->
   <div id="okeroiload" class="col-12 ">
 <div id="loadtable" class="card card-body border-0 shadow mb-4">  
    <div class="table-responsive py-4">
    <table class="table table-flush" id="tableproduct">
        <thead class="thead-light">
        <tr>
            <th >Má SP</th>
            <th >Tên sản phẩm</th>
            <th >Hình đại diện</th>
            <th >Hình nền</th>
            <th>Chất liệu</th>
             <th>Giá</th>
             <th>Mô tả</th>
             <th>Trạng thái</th>
             <th>Chức năng</th>
        </tr>
        </thead>
        <tbody>
        <tr class="products" th:each = "list : ${product}">
            <td class="idproduct" id="khangcogi1" th:value=${list.Id_Poroduct}>[[${list.Id_Poroduct}]]</td>
            <td class="productName" id="khangcogi" th:text=${list.Product_Name}></td>
            <td class="image" th:value="${list.Image}">
             <img  width="40%" th:src="@{'/view/images/' + ${list.Image}}" alt="&#193;o Thun Cổ Tr&#242;n Tối Giản Ver12" />
             </td>
            <td class="image"  th:value="${list.Image1}">
             <img  width="40%"  th:src="@{'/view/images/' + ${list.Image1}}" alt="&#193;o Thun Cổ Tr&#242;n Tối Giản Ver12" />
             </td>
     		   
               <td class="Fabric_Material" >[[${list.Fabric_Material}]] </td>
                <td class="Descriptions" th:text="${#numbers.formatDecimal(list.import_Price, 0, 'COMMA', 0, 'POINT')}" ></td>
                
                 <td class="Descriptions"  id="khangcogi1">[[${list.Descriptions}]]</td>
                  
            	<td> <span th:data-id="${list.Id_Poroduct}" th:data-name="${list.status}"
            	onclick="activeCategory(this.getAttribute('data-id'), this.getAttribute('data-name'))"
            	 class=" btn badge bg-secondary activeCategory" th:if="${list.status == 0}"  th:value=${list.status}>Hoạt động</span>
            			<span	th:data-id="${list.Id_Poroduct}" th:data-name="${list.status}"
            			onclick="activeCategory(this.getAttribute('data-id'), this.getAttribute('data-name'))"
            			 class=" btn badge bg-danger activeCategory" th:if="${list.status == 1}"  th:value=${list.status}>Ngừng kinh doanh</span>
            			
            	</td>
          		<td><a th:data-id="${list.Id_Poroduct}"
          		onclick="btninfoaize(this.getAttribute('data-id'))"
          		 class="btn-sm btn-outline-info btninfoaize"><i class="fas fa-edit"></i></a>

          			<a th:data-id="${list.Id_Poroduct}"
          				th:data-name="${list.Product_Name}"
          				onclick="showmodal(this.getAttribute('data-id'), this.getAttribute('data-name'))"
						 class="btn-sm btn-outline-danger btnDelete"><i class="fa fa-trash"></i></a>
          		</td>
        </tr>
       
        </tbody>
        
    </table>
    </div>
    	<div class="dataTable-bottom"><div class="dataTable-info">Hiển thị 1 đến <span id="showtheo">15</span> trên [[${sum.size}]] mục</div><nav aria-label="Page navigation example">
  	 <nav aria-label="Page navigation example" >
    	<ul class="pagination mb-0">
       	 <li class="page-item">
            <a class="page-link" href="#">‹</a>
        	</li>
        	<th:block th:each="i: ${#numbers.sequence(1, 5)}">
        <li class="page-item active">
            <a class="page-link " href="#" th:if="${i == 1}">[[${i}]]</a>
             
        </li>
         <li class="page-item">
            <a class="page-link " href="#" th:if="${i > 1}">[[${i}]]</a>
             
        </li>
        	 </th:block>
       	 <li class="page-item">
            <a class="page-link" href="#">›</a>
        </li>
       
    </ul>
</nav></div>
		
                    </div>
                  
                </div>

  		
               
<div class="modal fade" id="modal-default" tabindex="-1" role="dialog" aria-labelledby="modal-default" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="h6 modal-title">Cảnh báo</h2>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              Bạn có muốn xoá sản phẩm với mã ="<span id="id123"></span>" tên ="<span id="sizeName1"></span>"   ?
            </div>
            <div class="modal-footer">
             
                <button type="button" class="btn btn-link text-gray" data-bs-dismiss="modal">Huỷ bỏ</button>
                 <a id="yesOption" 
               		 
                   type="button" class="btn btn-secondary">Đồng ý</a>
            </div>
        </div>
    </div>
</div>
                  

<!-- End of Modal Content -->     
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script>

function xoactsp(el){
	
	jQuery(el).closest("div").find(".detailsproduct").remove();
	
	jQuery(el).remove();
}
function onclick(el){
	
}

         function showmodal(id,name){
 	console.log(name,id)
 	var khang = $('#sizeName1').text(name);
 	$("#id123").text(id);
 	$('#modal-default').modal('show');

 }



    </script>    
 
 <script>
 $("#showadd").click(function(){
		
		$('#modalSubscribe').modal('show');

		$("#formproduct").trigger("reset");
		/*  document.getElementById("image").remove(); 
		 document.getElementById("imagenen").remove(); */
		 $("#btnupdate").hide();
	})
function nhanjson(data){
	 var tablecategory =$("#tableproduct").find("tbody");
		tablecategory.empty();
	for(var i = 0; i<data.length; i++){
		const price = data[i].retail_Price;
		const formatprice = price.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',')
		if(data[i].status == 0){
			tablecategory.append('<tr class="categorys">'
			+ '<td class="IdCategory1"> '+ data[i].id_Poroduct +' </td>'
			+'<td class="categoryName" id="khangcogi"> ' + data[i].product_Name  +' </td>'
			+'<td class="image"> ' 
			  +'<img  width="40%" width="40%"  src="/view/images/'+  data[i].image  +' ">'
			  +' </td>'
			  +'<td class="image"> ' 
			  +'<img  width="40%"  src="/view/images/'+  data[i].image1  +' ">'
			  +' </td>'		
			+'<td class="fabric_Material"> ' + data[i].fabric_Material  +' </td>'
			+'<td class="Price"> ' + formatprice   +' </td>'
			
			+'<td class="Descriptions" id="khangcogi1"> ' + data[i].descriptions  +' </td>'
		
			+"<td> <span class=\" btn badge bg-secondary\" data-id= " + data[i].id_Poroduct +" data-name= " + data[i].status +"  " 
			+ "onclick=\"activeCategory(this.getAttribute('data-id'), this.getAttribute('data-name'))\"  value = "+ data[i].status +" >  Hoạt động</span> </td>\r\n"
			+"<td><a  data-id= " + data[i].id_Poroduct +"\r\n"
			+ " onclick=\"btninfoaize(this.getAttribute('data-id'))\"\r\n"
			+ "        class=\"btn-sm btn-outline-info \" ><i class=\"fas fa-edit\"></i></a>\r\n"
			+ "<a data-id= " + data[i].id_Poroduct+"\r\n"
			+ "data-name=" + data[i].product_Name +"\r\n"
			+ "onclick=\"showmodal(this.getAttribute('data-id'), this.getAttribute('data-name'))\"\r\n"
			+ "class=\"btn-sm btn-outline-danger btnDelete\"><i class=\"fa fa-trash\"></i></a> </td>\r\n"
			+"</tr>")
		
			}
			else{
				tablecategory.append('<tr class="categorys">'
						+ '<td class="IdCategory1"> '+ data[i].id_Poroduct +' </td>'
						+'<td class="categoryName" id="khangcogi"> ' + data[i].product_Name  +' </td>'
						+'<td class="image"> ' 
						  +'<img class="img-fluids"  src="/view/images/'+  data[i].image  +' ">'
						  +' </td>'
						  +'<td class="image"> ' 
						  +'<img class="img-fluids"  src="/view/images/'+  data[i].image1  +' ">'
						  +' </td>'		
						+'<td class="fabric_Material"> ' + data[i].fabric_Material  +' </td>'
						+'<td class="Price"> ' + formatprice  +' </td>'
						
						+'<td class="Descriptions" id="khangcogi1"> ' + data[i].descriptions  +' </td>'
					
						+"<td> <span class=\" btn badge bg-danger\" data-id= " + data[i].id_Poroduct +" data-name= " + data[i].status +"  " 
						+ "onclick=\"activeCategory(this.getAttribute('data-id'), this.getAttribute('data-name'))\"  value = "+ data[i].status +" >  Ngưng hoạt động</span> </td>\r\n"
						+"<td><a  data-id= " + data[i].id_Poroduct +"\r\n"
						+ " onclick=\"btninfoaize(this.getAttribute('data-id'))\"\r\n"
						+ "        class=\"btn-sm btn-outline-info \" ><i class=\"fas fa-edit\"></i></a>\r\n"
						+ "<a data-id= " + data[i].id_Poroduct+"\r\n"
						+ "data-name=" + data[i].product_Name +"\r\n"
						+ "onclick=\"showmodal(this.getAttribute('data-id'), this.getAttribute('data-name'))\"\r\n"
						+ "class=\"btn-sm btn-outline-danger btnDelete\"><i class=\"fa fa-trash\"></i></a> </td>\r\n"
						+"</tr>")
			}
		
	}
}
 function DelImg(el) {
     jQuery(el).closest('div').find("img").remove()
    console.log(el)
     
 }
 
	function searchByName(praram){
		var txtseach = praram.value;
		 var status=document.getElementById("metlamroi").value;  
		  var solimit=document.getElementById("showme").value;  
		 
		$.ajax({
			url:"/admin/product/searchByName",
			type: "GET",
			data:{
				name:txtseach,
				status:status,
				solimit:solimit,
			},
			success: function(value){
				//self.closest("tr").remove();
				nhanjson(value)
console.log(value)
			}
		}) 
	}
	
	
	  	 	function btninfoaize(id){
			var idproduct = id;
			$("#idproducts").val(id);
				 $.ajax({
					url:"/admin/product/bingdingupdate",
					type: "GET",
					data:{
						id:id,
											},
					success: function(value){
						//self.closest("tr").remove();
						$('#modalSubscribe').modal('show');
						$("#formproduct").trigger("reset");
						console.log(value)
					$("#idproducts").val(value.id_Poroduct);
					$("#productName").val(value.product_Name);
					$("#fabric_material").val(value.fabric_Material);
					$("#price1").val(value.gianha);
					$("#pricegiaban").val(value.price);
					$("#descriptions").val(value.descriptions)
					 var solimit= document.getElementById("image").remove(); 
					 
					 const images = document.createElement('img')
					  images.src  = '/view/images/'+ value.image;
					 images.id="image"
					 images.style.width = "50%"
					  document.querySelector('#bingdingimage').appendChild(images)
					  document.getElementById("imagenen").remove();
					   const imagesn = document.createElement('img')
					  imagesn.src  = '/view/images/'+ value.image1;
					   imagesn.id="imagenen"
					 imagesn.style.width = "50%"
					  document.querySelector('#bingdingimagen').appendChild(imagesn)
					  
					 
					 
					  
					//$("#formFile").val(value.image);	
					$("#Id_Category1").val(value.category.id_Category);
					$("#idbrand1").val(value.brand.id_Brand);
					$("#containerptoductdetail").html('');
					for( i=0; i<value.product_details.length; i++){
					var productdetailclone = $("#addproductdeltai").clone().removeAttr("id");
					productdetailclone.find("#iddetailsproductcolor").val(value.product_details[i].product_Color.id_Product_Color);
					productdetailclone.find("#iddetailssize").val(value.product_details[i].size.id_Size);
					productdetailclone.find("#quantity").val(value.product_details[i].quantity);
					productdetailclone.find("#user_Manual").val(value.product_details[i].id_Product_Details);
					$("#containerptoductdetail").append(productdetailclone);
					}
					 $("#btnsaveproduct").hide();
					 $("#btnupdate").show();
					
					}
				}) 
	}
 //update status
  $(document).ready(function(){
			
				$("body").on("click", "#btnaddproductdetails", function(){
					var productdetailclone = $("#addproductdeltai").clone().removeAttr("id");
					
					$("#containerptoductdetail").append(productdetailclone);
				})
				$("body").on("click", ".closeproductdetail", function(){
					//var productdetailclone = $("#addproductdeltai").clone().attr("id");
				//	$("#containerptoductdetail").empty(productdetailclone);
					//var k = $(".khangco");
					//k.empty();
				
				})
 
		$("#yesOption").click(function(){
			var id = document.getElementById("id123").innerHTML;
			var status=document.getElementById("metlamroi").value;  
			  var solimit=document.getElementById("showme").value; 
			  
			
			  var self = $(this);
			  $.ajax({
					url:"/admin/product/ajaxdelete",
					type: "POST",
					data:{
					
						id:id,
						status:status,
						solimit:solimit,					},
					success: function(value){
						//self.closest("tr").remove();
						console.log(value)
						$('#modal-default').modal('hide');
						 const notyf = new Notyf({
				                position: {
				                    x: 'right',
				                    y: 'top',
				                },
				                types: [
				                    {
				                        type: 'error',
				                        background: '#FA5252',
				                        icon: {
				                            className: 'fas fa-times',
				                            tagName: 'span',
				                            color: '#fff'
				                        },
				                        dismissible: false
				                    }
				                ]
				            });	
						 notyf.open({
				                type: 'error',
				                message:'Xoa thành công '
				                
				            });
						 nhanjson(value)
					}
				}) 
			
		})
	  
	  
	
	  // reset form
	  $("#btnreset").click(function(){
		  $("#btnSaveCategory").show();
		  $("#btnupdate").hide();
	  })
	  // b
	 
  })
   function activeCategory(id,status){
	  var solimit=document.getElementById("showme").value;  
	   var status1=document.getElementById("metlamroi").value; 
	   $.ajax({
			url:"/admin/product/updatestatus",
			type: "POST",
			data:{
				id:id,
				status,
				solimit:solimit,
				status1:status1,
			},
			success: function(value){
				//self.closest("tr").remove();	
			 const notyf = new Notyf({
					                position: {
					                    x: 'right',
					                    y: 'top',
					                },
					                types: [
					                    {
					                        type: 'info',
					                        background: '#0948B3',
					                        icon: {
					                            className: 'fas fa-check',
					                            tagName: 'span',
					                            color: '#fff'
					                        },
					                        dismissible: false
					                    }
					                ]
					            });
							 notyf.open({
					                type: 'info',
					                message: 'Cập nhật trạng thái thành công.'
					            });	
				nhanjson(value)
			}
		}) 
	   
}
//show status
	$("body").on("change", "#metlamroi", function(){
		  var status=document.getElementById("metlamroi").value;  
		  var solimit=document.getElementById("showme").value;  
			
		  $.ajax({
				url:"/admin/product/showstatus",
				type: "GET",
				data:{
					status:status,
					solimit:solimit,
				},
				success: function(data){
					//self.closest("tr").remove();
					console.log(data)	
					nhanjson(data)

				}
			}) 
		 
	  })
	  
	     $("body").on("change", "#showme", function(){
		  var solimit=document.getElementById("showme").value;  
		  var status=document.getElementById("metlamroi").value; 
			
		  $.ajax({
				url:"/admin/product/showlimit",
				type: "GET",
				data:{
					solimit:solimit,
					status:status,
				},
				success: function(value){
					nhanjson(value)	
						//tablecategory.append(value);	
						$("#showtheo").html(solimit);
				}
			}) 
		
		
})
  // phan trang
	  
	  $("body").on("click", ".page-item", function(){
		  $(".page-item").removeClass("active");
		  $(this).addClass("active");
		  var status=document.getElementById("metlamroi").value;  
		  var solimit=document.getElementById("showme").value; 
		  
		
		  var sotrang = $(this).text();
		  var spbatdau = (sotrang -1)*solimit;
		 
		   $.ajax({
				url:"/admin/product/pagingproduct",
				type: "GET",
				data:{
					spbatdau:spbatdau,
					status:status,
					solimit:solimit,
				},
				success: function(value){
					console.log(value)
					nhanjson(value);
					
				}
			})  
	  })

	  //
             $(document).ready(function(){
	
              $("#close").click(function(){
            	
            	  $("#formsize").trigger("reset");
              })
              
              var files = []
              var image = "";
              $("#formFile").change(function(event){
				
				files = event.target.files;
				image = files[0].name;
				forms = new FormData();
				forms.append("file", files[0]);
})
              
 			var filesn = []
              var imagen = "";
              $("#formFiles").change(function(event){
				
				filesn = event.target.files;
				imagen = filesn[0].name;
				forms = new FormData();
				forms.append("file", files[0]);
				console.log(imagen)
})

// save 
					$("#btnsaveproduct").click(function(){
						var formsize = $("#formproduct").serializeArray();
						var productName = document.getElementById("productName").value;
						var status=document.getElementById("metlamroi").value;  
						  var solimit=document.getElementById("showme").value;
						   console.log(formsize)
						json = {};
						
						arraryDetails = [];
						$.each(formsize, function(i, field){
				    		json[field.name] = field.value;	
			});		
				$("#containerptoductdetail >.detailsproduct").each(function(){
					objectDetails = {};
					idproductclor = $(this).find('select[name="idproductColor"]').val();
					idsize = $(this).find('select[name="idsize"]').val();
					quantity = $(this).find('input[name="quantity"]').val();
					usermanual = $(this).find('input[name="Usermanual"]').val();
					objectDetails["idproductclor"] = idproductclor;
					objectDetails["idsize"] = idsize;
					objectDetails["quantity"] = quantity;
					objectDetails["usermanual"] = usermanual;
					arraryDetails.push(objectDetails);
					
				})
				
				
				json["productdetails"] = arraryDetails;
				json["Image"] = image;
				json["Imagenen"] = imagen;
				console.log(json)
				if(productName == ""	){
				 const notyf = new Notyf({
		                position: {
		                    x: 'right',
		                    y: 'top',
		                },
		                types: [
		                    {
		                        type: 'warning',
		                        background: '#F5B759',
		                        icon: {
		                            className: 'fas fa-exclamation-triangle',
		                            tagName: 'span',
		                            color: '#fff'
		                        },
		                        dismissible: false
		                    }
		                ]
		            });
				 notyf.open({
		                type: 'warning',
		                message: 'Tên sản phẩm không được để trống.'
		              
		            });
				 
					return false;
					
						} else{
							 $.ajax({
									url:"/admin/product/ajaxsaveproduct",
									type: "POST",
									data:{
										dataJson:JSON.stringify(json),
										status:status,
										solimit:solimit,
									},

							}).done(function(data){
								console.log(data);
				
								 for(var i = 0; i<data.length; i++)
								if(data[i].product_Name === null){
									 const notyf = new Notyf({
							                position: {
							                    x: 'right',
							                    y: 'top',
							                },
							                types: [
							                    {
							                        type: 'error',
							                        background: '#FA5252',
							                        icon: {
							                            className: 'fas fa-times',
							                            tagName: 'span',
							                            color: '#fff'
							                        },
							                        dismissible: false
							                    }
							                ]
							            });	
									 notyf.open({
							                type: 'error',
							                message:'Tên sản phẩm đã tồn tại trông hệ thống !'
							                
							            });
								}else{
									
										$('#modalSubscribe').modal('hide');
										 const notyf = new Notyf({
								                position: {
								                    x: 'right',
								                    y: 'top',
								                },
								                types: [
								                    {
								                        type: 'info',
								                        background: '#0948B3',
								                        icon: {
								                            className: 'fas fa-check',
								                            tagName: 'span',
								                            color: '#fff'
								                        },
								                        dismissible: false
								                    }
								                ]
								            });
										 notyf.open({
								                type: 'info',
								                message: 'Sản phẩm đã được thêm thành công.'
								            });	
										nhanjson(data);
										
								
									
								}
						
							})
						}
			
					   
		})

// update 
$("#btnupdate").click(function(){
						var formsize = $("#formproduct").serializeArray();
						var productName = document.getElementById("productName").value;
						var status=document.getElementById("metlamroi").value;  
						  var solimit=document.getElementById("showme").value;
						   console.log(formsize)
						json = {};
						
						arraryDetails = [];
						$.each(formsize, function(i, field){
				    		json[field.name] = field.value;	
			});		
						$("#containerptoductdetail >.detailsproduct").each(function(){
					objectDetails = {};
					idproductclor = $(this).find('select[name="idproductColor"]').val();
					idsize = $(this).find('select[name="idsize"]').val();
					quantity = $(this).find('input[name="quantity"]').val();
					usermanual = $(this).find('input[name="Usermanual"]').val();
					objectDetails["idproductclor"] = idproductclor;
					objectDetails["idsize"] = idsize;
					objectDetails["quantity"] = quantity;
					objectDetails["usermanual"] = usermanual;
					arraryDetails.push(objectDetails);
				})
				json["productdetails"] = arraryDetails;
				json["Image"] = image;
				json["Imagenen"] = imagen;
				console.log(json)
				if(productName == ""	){
				 const notyf = new Notyf({
		                position: {
		                    x: 'right',
		                    y: 'top',
		                },
		                types: [
		                    {
		                        type: 'warning',
		                        background: '#F5B759',
		                        icon: {
		                            className: 'fas fa-exclamation-triangle',
		                            tagName: 'span',
		                            color: '#fff'
		                        },
		                        dismissible: false
		                    }
		                ]
		            });
				 notyf.open({
		                type: 'warning',
		                message: 'Please enter your product name.'
		              
		            });
				 
					return false;
						} else{
							 $.ajax({
									url:"/admin/product/ajaxupdate",
									type: "POST",
									data:{
										dataJson:JSON.stringify(json),
										status:status,
										solimit:solimit,
									},

							}).done(function(data){
								console.log(data);
								$('#modalSubscribe').modal('hide');
								 for(var i = 0; i<data.length; i++)
								if(data[i].product_Name === null){
									 const notyf = new Notyf({
							                position: {
							                    x: 'right',
							                    y: 'top',
							                },
							                types: [
							                    {
							                        type: 'error',
							                        background: '#FA5252',
							                        icon: {
							                            className: 'fas fa-times',
							                            tagName: 'span',
							                            color: '#fff'
							                        },
							                        dismissible: false
							                    }
							                ]
							            });	
									 notyf.open({
							                type: 'error',
							                message:'Size name is duplicate !'
							                
							            });
								}else{
									
									
									 const notyf = new Notyf({
							                position: {
							                    x: 'right',
							                    y: 'top',
							                },
							                types: [
							                    {
							                        type: 'info',
							                        background: '#0948B3',
							                        icon: {
							                            className: 'fas fa-check',
							                            tagName: 'span',
							                            color: '#fff'
							                        },
							                        dismissible: false
							                    }
							                ]
							            });
									 notyf.open({
							                type: 'info',
							                message: 'Cập nhật sản phẩm thành công thành công.'
							            });	
							
										nhanjson(data);
										
								
									
								}
						
							})
						}
			
					   
		})
					
})

</script>
                    </div>
                </div>
            </div>
 


</body>
</html>